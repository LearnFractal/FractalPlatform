function t_isEmptyObject(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function t_triggerEvent(t,e){var o;document.createEvent?(o=document.createEvent("HTMLEvents")).initEvent(e,!0,!1):document.createEventObject&&((o=document.createEventObject()).eventType=e),o.eventName=e,t.dispatchEvent?t.dispatchEvent(o):t.fireEvent?t.fireEvent("on"+o.eventType,o):t[e]?t[e]():t["on"+e]&&t["on"+e]()}window.tildaForm.addPaymentInfoToForm=function(t){t instanceof Element||(t=t[0]);var e=document.getElementById("allrecords"),o=t.querySelector(".js-tilda-payment");o&&t_removeEl(o);var a="",r=0;window.tildaForm.tildapayment={},window.tildaForm.arProductsForStat=[],window.tildaForm.orderIdForStat="",window.tildaForm.amountForStat=0,window.tildaForm.currencyForStat="";var i=e.getAttribute("data-tilda-currency")||"";if(!i){var n=document.querySelector(".t706");i=n?n.getAttribute("data-project-currency-code"):""}i?(window.tildaForm.currencyForStat=i,window.tildaForm.tildapayment.currency=i):window.tcart.currency&&(window.tildaForm.currencyForStat=window.tcart.currency,window.tildaForm.tildapayment.currency=window.tcart.currency);var s=document.querySelector(".t-radio_delivery:checked");if(!window.tcart.delivery&&s&&parseInt(s.getAttribute("data-delivery-price"),10)>0)try{return window.tildaForm.tildapayment=!1,window.location.reload(),!1}catch(S){}window.tildaForm.amountForStat=window.tcart.amount,window.tildaForm.tildapayment.amount=window.tcart.amount,window.tcart.system?window.tildaForm.tildapayment.system=window.tcart.system:window.tildaForm.tildapayment.system="auto",window.tcart.promocode&&window.tcart.promocode.promocode&&(window.tildaForm.tildapayment.promocode=window.tcart.promocode.promocode,window.tcart.prodamount_discountsum&&parseFloat(window.tcart.prodamount_discountsum)>0?(window.tildaForm.tildapayment.discount=window.tcart.prodamount_discountsum,r=window.tcart.prodamount_discountsum):window.tcart.amount_discountsum&&parseFloat(window.tcart.amount_discountsum)>0&&(window.tildaForm.tildapayment.discount=window.tcart.amount_discountsum,r=window.tcart.amount_discountsum),window.tcart.prodamount_withdiscount&&parseFloat(window.tcart.prodamount_withdiscount)>0&&(window.tildaForm.tildapayment.prodamount_withdiscount=window.tcart.prodamount_withdiscount),window.tcart.amount_withoutdiscount&&parseFloat(window.tcart.amount_withoutdiscount)>0&&(window.tildaForm.tildapayment.amount_withoutdiscount=window.tcart.amount_withoutdiscount)),window.tcart.dyndiscount&&(window.tildaForm.tildapayment.dyndiscount=window.tcart.dyndiscount),window.tcart.prodamount_withdyndiscount&&(window.tildaForm.tildapayment.prodamount_withdyndiscount=window.tcart.prodamount_withdyndiscount),window.tcart.prodamount&&parseFloat(window.tcart.prodamount)>0&&(window.tildaForm.tildapayment.prodamount=window.tcart.prodamount);var d=[],c=window.tcart.products;Array.prototype.forEach.call(c,(function(t){t_isEmptyObject(t)||"yes"===t.deleted||d.push(t)})),window.tcart.products=d;var l,u=(new Date).getTimezoneOffset();window.tildaForm.tildapayment.timezoneoffset=u;var w={},m="",p=0;window.tcart.products&&window.tcart.products.length>0&&(p=window.tcart.products.length),window.tildaForm.tildapayment.products=[];for(var y=0;y<p;y++){var a=window.tcart.products[y];for(var f in w={},m="",window.tildaForm.tildapayment.products[y]={},a)if("function"!=typeof a[f])if("options"===f)for(var v in window.tildaForm.tildapayment.products[y][f]={},a[f])window.tildaForm.tildapayment.products[y][f][v]||(window.tildaForm.tildapayment.products[y][f][v]={}),a[f][v].option&&(window.tildaForm.tildapayment.products[y][f][v].option=a[f][v].option),a[f][v].price&&a[f][v].price>0&&(window.tildaForm.tildapayment.products[y][f][v].price=a[f][v].price),a[f][v].variant&&(window.tildaForm.tildapayment.products[y][f][v].variant=a[f][v].variant),a[f][v].option&&a[f][v].variant&&(m&&(m+=", "),m=m+a[f][v].option+":"+a[f][v].variant);else window.tildaForm.tildapayment.products[y][f]=a[f];a.sku?w.id=a.sku:a.uid&&(w.id=a.uid),w.name=a.name,a.price?(w.price=a.price,w.quantity=parseInt(a.amount/a.price)):a.quantity&&a.quantity>1?(w.price=a.amount/a.quantity,w.quantity=a.quantity):(w.price=a.amount,w.quantity=1),w.name=a.name,m&&(w.variant=m),a.sku&&(w.sku=a.sku),a.uid&&(w.uid=a.uid),window.tildaForm.arProductsForStat.push(w)}var g=0;window.tcart.delivery&&window.tcart.delivery.name&&(window.tildaForm.tildapayment.delivery={name:window.tcart.delivery.name},window.tcart.delivery&&window.tcart.delivery.price>=0&&(g=window.tcart.delivery.price,window.tildaForm.tildapayment.delivery.price=window.tcart.delivery.price,window.tcart.prodamount>0&&window.tcart.delivery.freedl&&window.tcart.delivery.freedl>0&&(window.tildaForm.tildapayment.delivery.freedl=window.tcart.delivery.freedl,window.tcart.prodamount-r>=window.tcart.delivery.freedl&&(g=0)),w={name:window.tcart.delivery.name,price:g,quantity:1,id:"delivery"},window.tildaForm.arProductsForStat.push(w)));try{var b=["city","street","pickup-name","pickup-address","pickup-id","house","entrance","floor","aptoffice","phone","entrancecode","comment","service-id","hash","postalcode","country","userinitials","onelineaddress","lang"];Array.prototype.forEach.call(b,(function(t){window.tcart.delivery&&window.tcart.delivery[t]&&(window.tildaForm.tildapayment.delivery[t]=window.tcart.delivery[t])}))}catch(S){}},window.tildaForm.payment=function(form,objNext){form instanceof Element||(form=form[0]);var successBox=form.querySelector(".js-successbox");if("y"!==form.getAttribute("data-formpaymentoff")){if(successBox){var successBoxText=successBox.textContent||successBox.innerText;successBoxText&&(form.tildaSuccessMessage=successBoxText),t_forms__getMsg("successorder")&&(successBox.innerHTML=t_forms__getMsg("successorder")),successBox.style.display="block"}if(t_addClass(form,"js-send-form-success"),"link"===objNext.type)return window.tildaForm.clearTCart(form),objNext.message&&successBox&&(successBox.innerHTML=objNext.message,successBox.style.display="block"),window.location.href=objNext.value,!0;if("form"===objNext.type){var paymentForm=document.getElementById("js-tilda-payment-formid"),strHtml="",valueKey="";for(var key in paymentForm&&t_removeEl(paymentForm),strHtml='<form id="js-tilda-payment-formid" action="'+objNext.value.action+'" method="post"  style="position: absolue; opacity: 0; width: 1px; height: 1px; left: -5000px;">',objNext.value.action="",objNext.value)valueKey=objNext.value[key],"function"!=typeof valueKey&&valueKey&&(strHtml+="<input type='hidden' name='"+key+"' value='"+valueKey+"' >");strHtml+="</form>",document.body.insertAdjacentHTML("beforeend",strHtml),paymentForm=document.getElementById("js-tilda-payment-formid"),window.tildaForm.clearTCart(form),paymentForm.getAttribute("action")?paymentForm.submit():setTimeout((function(){paymentForm.submit()}),200)}if("function"===objNext.type){var arrArgs=objNext.value.args;return objNext.value.functioncode?window.tildaForm.paysystemRun(objNext.value.script,objNext.value.sysname,form,objNext.value.functioncode,arrArgs):"undefined"!=typeof jQuery?eval(objNext.value.name+"($(form), arrArgs);"):eval(objNext.value.name+"(form, arrArgs);"),!1}window.tildaForm.clearTCart(form),"text"===objNext.type&&objNext.message&&successBox&&(successBox.innerHTML=objNext.message,successBox.style.display="block")}else window.tildaForm.clearTCart(form)},window.tildaForm.paysystemScriptLoad=function(t,e){if(!e||!t||"http"!==t.substring(0,4))return console.log("Wrong script parameters."),!1;if(window.scriptSysPayment||(window.scriptSysPayment={}),!window.scriptSysPayment[e]||!0!==window.scriptSysPayment[e]){var o=document.createElement("script");o.type="text/javascript",o.src=t,document.body.appendChild(o),window.scriptSysPayment[e]=!0}},window.tildaForm.paysystemRun=function(linkScript,systemName,form,functionCode,arArgs){if(form instanceof Element||(form=form[0]),window.scriptSysPayment||(window.scriptSysPayment={}),!window.scriptSysPayment[systemName]||!0!==window.scriptSysPayment[systemName])return window.tildaForm.paysystemScriptLoad(linkScript,systemName),window.setTimeout((function(){window.tildaForm.paysystemRun(linkScript,systemName,form,functionCode,arArgs)}),200),!1;var script=linkScript,sysname=systemName,functioncode=functionCode,objArgs=arArgs;if("undefined"!=typeof jQuery)var $jform=$(form);eval(functionCode)},window.tildaForm.paysystemSuccess=function(t,e){t instanceof Element||(t=t[0]),window.tildaForm.clearTCart(t);var o=document.getElementById("allrecords"),a=t.getAttribute("id"),r=t.querySelector(".js-successbox"),i="/tilda/"+a+"/payment/",n="Pay order in form "+a,s=e.amount,d=e.description;if(window.dataSuccessMessage="",window.Tilda&&"function"==typeof window.Tilda.sendEventToStatistics){var c=o.getAttribute("data-tilda-currency")||"";if(!c){var l=document.querySelector(".t706");c=l?l.getAttribute("data-project-currency-code"):""}c||o.setAttribute("data-tilda-currency",e.currency),window.Tilda.sendEventToStatistics(i,n,d,s)}t.tildaSuccessMessage&&(window.dataSuccessMessage=t.tildaSuccessMessage),e.successurl&&window.setTimeout((function(){window.location.href=e.successurl}),300),r.innerHTML=window.dataSuccessMessage?window.dataSuccessMessage:"",t.tildaSuccessMessage="";var u=t.getAttribute("data-success-callback");window.tildaForm.successEnd(t,e.successurl,u),t_triggerEvent(t,"tildaform:aftersuccess")},window.tildaForm.stripeLoad=function(){if(!window.stripeapiiscalled){var t=document.createElement("script");t.type="text/javascript",t.src="https://checkout.stripe.com/checkout.js",document.body.appendChild(t),window.stripeapiiscalled=!0}},window.tildaForm.stripePay=function(t,e){if(t instanceof Element||(t=t[0]),!0!==window.stripeapiiscalled)return window.tildaForm.stripeLoad(),window.setTimeout((function(){window.tildaForm.stripePay(t,e)}),200),!1;window.dataSuccessMessage="";var o=document.getElementById("allrecords"),a=e.companyname,r=e.companylogo;if(a||(a=window.location.host),!window.stripehandler){if("object"!=typeof window.StripeCheckout)return window.setTimeout((function(){window.tildaForm.stripePay(t,e)}),200),!1;var i={key:e.accountid,image:r,name:a,locale:"auto"};e.zipCode&&1===e.zipCode&&(i.zipCode=!0),e.billingAddress&&1===e.billingAddress&&(i.billingAddress=!0),e.shipping&&1===e.shipping&&(i.shippingAddress=!0),window.stripehandler=window.StripeCheckout.configure(i),t_addEventListener(window,"popstate",(function(){window.stripehandler.close()}))}window.tildaForm.orderIdForStat=e.invoiceid;var n=100;e.multiple&&e.multiple>0&&(n=parseInt(e.multiple,10));var s=t.getAttribute("id");window.stripehandler.open({name:a,image:r,description:e.description,amount:parseInt((parseFloat(e.amount)*n).toFixed()),currency:e.currency,shippingAddress:"1"==e.shipping,email:e.email>""?e.email:"",token:function a(r){if(r&&r.id){var i=[{name:"projectid",value:e.projectid},{name:"invoiceid",value:e.invoiceid},{name:"token",value:r.id},{name:"email",value:r.email},{name:"currency",value:e.currency},{name:"amount",value:parseInt((parseFloat(e.amount)*n).toFixed())}];i=t_forms__formData(i);var d=new XMLHttpRequest;d.open("POST","https://"+window.tildaForm.endpoint+"/payment/stripe/",!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),d.onreadystatechange=function(){if(4===d.readyState&&d.status>=200&&d.status<400){var a=d.responseText,r;if(a)if("object"==typeof JSON.parse(a)){window.tildaForm.clearTCart(t);var i="/tilda/"+s+"/payment/",n="Pay order in form "+s,c=e.amount,l=e.description,u=t.querySelector(".js-successbox");if(window.Tilda&&"function"==typeof window.Tilda.sendEventToStatistics){var w=document.querySelector(".t706");o.getAttribute("data-tilda-currency")||w&&w.getAttribute("data-project-currency-code")||o.setAttribute("data-tilda-currency",e.currency),window.Tilda.sendEventToStatistics(i,n,l,c)}t.tildaSuccessMessage&&(window.dataSuccessMessage=t.tildaSuccessMessage),e.successurl&&window.setTimeout((function(){window.location.href=e.successurl}),300),u.innerHTML=window.dataSuccessMessage?window.dataSuccessMessage:"",t.tildaSuccessMessage="";var m=t.getAttribute("data-success-callback");window.tildaForm.successEnd(t,e.successurl,m),t_triggerEvent(t,"tildaform:aftersuccess")}}},d.send(i)}}})},window.tildaForm.cloudpaymentLoad=function(){if(!window.cloudpaymentsapiiscalled){var t=document.createElement("script");t.type="text/javascript",t.src="https://widget.cloudpayments.ru/bundles/cloudpayments.js",document.body.appendChild(t),window.cloudpaymentsapiiscalled=!0}},window.tildaForm.cloudpaymentPay=function(t,e){if(t instanceof Element||(t=t[0]),!0!==window.cloudpaymentsapiiscalled)return window.tildaForm.cloudpaymentLoad(),window.setTimeout((function(){window.tildaForm.cloudpaymentPay(t,e)}),200),!1;var o=document.getElementById("allrecords"),a=t.getAttribute("id"),r=t.querySelector(".js-successbox");window.dataSuccessMessage="";var i=e.currency,n=e.language,s={};if(n||(n="RUB"==i||"BYR"==i||"BYN"==i||"RUR"==i?"ru-RU":"UAH"==i?"uk":"en-US"),!window.cloudpaymentshandler){if("object"!=typeof window.cp)return window.setTimeout((function(){window.tildaForm.cloudpaymentPay(t,e)}),200),!1;s={language:n},e.applePaySupport&&"off"===e.applePaySupport&&(s.applePaySupport=!1),e.googlePaySupport&&"off"===e.googlePaySupport&&(s.googlePaySupport=!1),window.cloudpaymentshandler=new cp.CloudPayments(s)}var d={};d.projectid=e.projectid,e.cloudPayments&&(e.cloudPayments.recurrent||e.cloudPayments.customerReceipt)&&(d.cloudPayments=e.cloudPayments);var c="",l=t.closest(".t-popup_show");return l||(l=t.closest(".t706__cartwin_showed")),l&&(c=l.getAttribute("style"),l.style.zIndex=100),window.tildaForm.orderIdForStat=e.invoiceId,e.skin||(e.skin="classic"),window.cloudpaymentshandler.charge({publicId:e.publicId,description:e.description,amount:parseFloat(e.amount),currency:i,accountId:e.accountId,invoiceId:e.invoiceId,requireEmail:!0===e.requireEmail,email:e.email,skin:e.skin,data:d},(function(n){window.cloudpaymentshandler=!1,l&&c&&l.setAttribute("style",c);var s="/tilda/"+a+"/payment/",d="Pay order in form "+a,u=e.amount,w=e.description;o.setAttribute("data-tilda-currency",i),window.Tilda&&"function"==typeof window.Tilda.sendEventToStatistics&&window.Tilda.sendEventToStatistics(s,d,w,u),window.tildaForm.clearTCart(t),e.successurl&&window.setTimeout((function(){window.location.href=e.successurl}),300),t.tildaSuccessMessage&&(window.dataSuccessMessage=t.tildaSuccessMessage),r.innerHTML=window.dataSuccessMessage?window.dataSuccessMessage:"",t.tildaSuccessMessage="";var m=t.getAttribute("data-success-callback");window.tildaForm.successEnd(t,e.successurl,m),t_triggerEvent(t,"tildaform:aftersuccess")}),(function(o,a){if(l&&c&&l.setAttribute("style",c),e.failureurl)window.location.href=e.failureurl;else{if(l){var i=l.querySelector(".t706__cartwin-products"),n=l.querySelector(".t706__cartwin-prodamount-wrap"),s=l.querySelector(".t706__form-bottom-text");i&&(i.style.display="block"),n&&(n.style.display="block"),s&&(s.style.display="block")}var d=t.querySelector(".t-form__inputsbox");d&&(d.style.display="block");try{tcart__lockScroll()}catch(u){}}r.style.display="none",t.tildaSuccessMessage&&(window.dataSuccessMessage=t.tildaSuccessMessage),r.innerHTML=window.dataSuccessMessage?window.dataSuccessMessage:"",t.tildaSuccessMessage="",window.cloudpaymentshandler=!1})),!1},window.tildaForm.sendStatAndShowMessage=function(form,arArgs,sendStat){form instanceof Element||(form=form[0]);var allRecords=document.getElementById("allrecords"),formId=form.getAttribute("id"),successBox=form.querySelector(".js-successbox"),dataSuccessPopup=form.getAttribute("data-success-popup");if(window.dataSuccessMessage="",sendStat){var linkPage="/tilda/"+formId+"/payment/",title="Pay order in form "+formId,price=arArgs.amount,product=arArgs.description;if(window.Tilda&&"function"==typeof window.Tilda.sendEventToStatistics){var t706block=document.querySelector(".t706");allRecords.getAttribute("data-tilda-currency")||t706block&&t706block.getAttribute("data-project-currency-code")||allRecords.setAttribute("data-tilda-currency",arArgs.currency),window.Tilda.sendEventToStatistics(linkPage,title,product,price)}}successBox&&("y"===dataSuccessPopup&&(successBox.style.display="none"),arArgs.successmessage?successBox.innerHTML=arArgs.successmessage:form.tildaSuccessMessage?successBox.innerHTML=form.tildaSuccessMessage:t_forms__getMsg("success")?successBox.innerHTML=t_forms__getMsg("success"):successBox.innerHTML="",form.tildaSuccessMessage="","y"===dataSuccessPopup?window.tildaForm.showSuccessPopup(successBox.textContent||successBox.innerText):successBox.style.display="block"),t_addClass(form,"js-send-form-success"),window.tildaForm.clearTCart(form),arArgs.successurl&&window.setTimeout((function(){window.location.href=arArgs.successurl}),300);var successCallback=form.getAttribute("data-success-callback");successCallback&&0===successCallback.indexOf("window.")&&(successCallback=successCallback.split(".")[1]),successCallback&&"function"==typeof window[successCallback]&&("undefined"!=typeof jQuery?eval(successCallback+"($(form))"):eval(successCallback+"(form)"));var upwidgetRemoveBtns=form.querySelectorAll(".t-upwidget-container__data_table_actions_remove svg"),inputText=form.querySelectorAll('input[type="text"]'),inputPhone=form.querySelectorAll('input[type="tel"]'),inputTextarea=form.querySelectorAll("textarea");Array.prototype.forEach.call(upwidgetRemoveBtns,(function(t){t_triggerEvent(t,"click")})),Array.prototype.forEach.call(inputText,(function(t){t.value=""})),Array.prototype.forEach.call(inputPhone,(function(t){t.value=""})),Array.prototype.forEach.call(inputTextarea,(function(t){t.innerHTML="",t.value=""})),"undefined"!=typeof jQuery&&$(form).data("tildaformresult",{tranId:"0",orderId:"0"}),form.tildaTranId="0",form.tildaOrderId="0",t_triggerEvent(form,"tildaform:aftersuccess")},window.tildaForm.banktransferPay=function(t,e){if(t instanceof Element||(t=t[0]),e&&"fast"===e.condition)window.tildaForm.sendStatAndShowMessage(t,e,!0);else if(e&&e.html){var o=document.body,a;document.getElementById("allrecords").insertAdjacentHTML("beforeend",'<div id="banktransfer">'+e.html+"</div>");var r=document.getElementById("banktransfer"),i,n=document.querySelector(".t-banktransfer").querySelector(".t-popup__close");function s(){t_removeClass(o,"t-body_popupshowed"),r&&t_removeEl(r);try{"function"==typeof tcart__closeCart&&(tcart__closeCart(),setTimeout((function(){var e=t.closest(".t-popup_show");if(e||(e=t.closest(".t706__cartwin_showed")||t.closest(".t706__cartwin")),e){var o=e.querySelector(".t706__cartwin-products"),a=e.querySelector(".t706__cartwin-prodamount-wrap"),r=e.querySelector(".t706__cartwin-bottom"),i=t.querySelector(".t-form__inputsbox");o&&(o.style.display="block"),a&&(a.style.display="block"),r&&(r.style.display="block"),i&&(i.style.display="block")}}),300))}catch(e){}return!1}t_removeEventListener(n,"click",s),t_addEventListener(n,"click",s),t_addClass(o,"t-body_popupshowed");var d=document.getElementById("formbanktransfer"),c=[];function l(a){if((a=a||window.event).preventDefault?a.preventDefault():a.returnValue=!1,(c=window.tildaForm.validate(d))&&c.length>0)return window.tildaForm.showErrors(d,c),!1;var i=t_serializeArray(d);i=t_forms__formData(i);var n=new XMLHttpRequest;n.open("POST","https://"+window.tildaForm.endpoint+"/payment/banktransfer/",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.onreadystatechange=function(){if(4===n.readyState)if(n.status>=200&&n.status<400){var a=n.responseText;if(a){var i=JSON.parse(a);if("object"==typeof i){if(t_removeClass(o,"t-body_popupshowed"),r&&t_removeEl(r),i||(i={error:"Unknown error. Please reload page and try again later."}),i&&i.error)return alert(i.error),!1;window.tildaForm.sendStatAndShowMessage(t,e,!0)}}}else t_removeClass(o,"t-body_popupshowed"),r&&t_removeEl(r),alert(i)},n.send(i)}d&&(t_removeEventListener(d,"submit",l),t_addEventListener(d,"submit",l))}else window.tildaForm.sendStatAndShowMessage(t,e,!0)};
