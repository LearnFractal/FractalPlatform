function t396_initVideo(e){var t=e.querySelector(".tn-atom__videoiframe"),o=e.querySelector(".tn-atom");if(o&&t&&!t.querySelector("iframe, video")){o.style.backgroundColor="#000";var a=document.getElementById("allrecords"),i=e?e.closest(".r"):null,r={recid:i?i.id.replace("rec",""):"",elementID:e.getAttribute("data-elem-id")||"",hasCover:"y"===o.getAttribute("data-atom-video-has-cover"),hasAutoplay:"y"===t396_elem__getFieldValue(e,"autoplay"),hasInfo:"y"===t396_elem__getFieldValue(e,"showinfo"),hasLoop:"y"===t396_elem__getFieldValue(e,"loop"),isMuted:"y"===t396_elem__getFieldValue(e,"mute"),startSec:t396_elem__getFieldValue(e,"startsec")||"",endSec:t396_elem__getFieldValue(e,"endsec")||"",vimeoHash:t.getAttribute("data-vimeohash")||"",hiddenControls:"hidden"===t.getAttribute("data-video-controls"),isCoverFit:"cover"===t.getAttribute("data-video-object-fit"),isEditMode:!!a&&"edit"===a.getAttribute("data-tilda-mode"),isLazy:"y"===window.lazy},d,s="",n;document.createElement("script").textContent='lazyload_iframe = new LazyLoad({elements_selector: ".t-iframe"});';var l=t.getAttribute("data-youtubeid"),u=t.getAttribute("data-vimeoid"),c=t.getAttribute("data-mp4video"),v=t.getAttribute("data-vkvideoid"),_=t.getAttribute("data-rutubeid"),m=t.getAttribute("data-kinescopeid"),p=t.getAttribute("data-webmvideo"),y=t.getAttribute("data-iframevideo");if(l&&(s=t396_video__generateIframeSrc(l,r,"youtube"),d=t396_video__createIframe(s,r,"youtube"),r.isLazy||d.addEventListener("load",(function(){o.style.backgroundColor=""}))),u&&(s=t396_video__generateIframeSrc(u,r,"vimeo"),d=t396_video__createIframe(s,r,"vimeo")),v&&(s=t396_video__generateIframeSrc(v,r,"vkvideo"),d=t396_video__createIframe(s,r,"vkvideo")),_&&(s=t396_video__generateIframeSrc(_,r,"rutube"),d=t396_video__createIframe(s,r,"rutube")),m&&(s=t396_video__generateIframeSrc(m,r,"kinescope"),d=t396_video__createIframe(s,r,"kinescope")),y&&(d=t396_video__createIframe(s=y,r,"iframe")),c||p){var f=c||p;r.type="webm",c&&(r.type="mp4"),r.hasCover&&(r.isCoverFit=!0),d=t396_video__createVideoHTML(f,r);var h="display: flex; align-items: center;height:100%;";r.isCoverFit&&(h+="position: relative;"),t.style.cssText=h}if(r.hasCover)o.addEventListener("click",(function(){if(!o.querySelector("iframe, video")){d&&t.appendChild(d),o.style.backgroundImage="none";var e=o.querySelector(".tn-atom__video-play-link");e&&(e.style.display="none"),(c||p)&&d&&!o.processVideo&&(d.play(),o.processVideo=!0)}}));else if(d&&t.appendChild(d),l&&r.isLazy&&t396_video__processYoutubeIframeBgOnLoad(o,d),c||p){var b=t.querySelector("video");t396_video__setLoaderForHTMLVideo(o,b,r.isCoverFit),t396_video__lazyLoadProcessHTMLVideo(b,r),b&&!r.isEditMode&&r.hiddenControls&&!r.hasAutoplay&&b.addEventListener("click",(function(){b.readyState<2||(b.paused?b.play():b.pause())}))}}}function t396_video__processYoutubeIframeBgOnLoad(e,t){if(t&&e&&"MutationObserver"in window){var o=new MutationObserver((function(a){a.forEach((function(a){"attributes"===a.type&&"src"===a.attributeName&&a.target.src&&t.addEventListener("load",(function(){e.style.backgroundColor="",o.disconnect()}))}))}));o.observe(t,{attributes:!0})}}function t396_video__generateIframeSrc(e,t,o){var a,i={youtube:"https://www.youtube.com/embed/",vimeo:"//player.vimeo.com/video/",vkvideo:"https://vk.com/video_ext.php",rutube:"https://rutube.ru/play/embed/",kinescope:"https://kinescope.io/embed/"}[o],r=i+e+"?";if("youtube"===o&&(t.hasInfo&&(r+="&showinfo=1"),t.hasLoop&&(r+="&loop=1&playlist="+e),t.startSec>0&&(r+="&start="+t.startSec),t.endSec>0&&(r+="&end="+t.endSec),t.isMuted&&(r+="&mute=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1",t.hasCover&&(r+="&amp;rel=0")),r+="&enablejsapi=1"),"vimeo"===o&&(r+="color=ffffff&badge=0",t.vimeoHash&&(t.vimeoHash=t.vimeoHash.trim(),r+=t.vimeoHash?"&h="+t.vimeoHash+"&":""),t.hasInfo?r+="&title=1&byline=1&portrait=1":r+="&title=0&byline=0&portrait=0",t.hasLoop&&(r+="&loop=1"),t.isMuted&&(r+="&muted=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1"),r+="&api=1"),"vkvideo"===o){var d=e.split("_"),s=d[0],n=d[1],l=d[2];r=i+"?oid="+s+"&id="+n+"&color=ffffff1&hd=2",l&&(r+="&hash="+l),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1"),r+="&js_api=1"}return"rutube"===o&&(e.includes("?p=")&&(r=i+e),t.startSec>0&&(r+="&t="+t.startSec),t.endSec>0&&(r+="&stopTime="+t.endSec),t.isMuted&&(r+="&volume=0")),"kinescope"===o&&(t.startSec>0&&(r+="&t="+t.startSec),t.isMuted&&(r+="&volume=0")),r}function t396_video__createIframe(e,t,o){var a=document.createElement("iframe"),i=o;return i+="-iframe-"+t.recid+"-"+t.elementID,a.id=i,a.width="100%",a.height="100%",a.frameBorder="0",a.allowFullscreen=!0,a.allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;",!t.hasCover&&t.isLazy?(a.classList.add("t-iframe"),a.setAttribute("data-original",e)):a.src=e,t.hasCover&&(a.allow="autoplay"),a}function t396_video__createVideoHTML(e,t){var o=window.t396__isMobile&&window.isSafari&&!t.hasCover?"#t=0.001":"",a=e?'<source src="'+e+o+'" type="video/'+t.type+'">':"",i=document.createElement("video");return i.style.cssText="width: 100%;"+(t.hasCover?"":"display:none;")+(t.isCoverFit?"height: 100%; object-fit: cover; position: absolute;":"")+(t.hiddenControls&&!t.hasAutoplay?"cursor: pointer;":""),i.id="html-video-"+t.recid+"-"+t.elementID,i.innerHTML=a,t.hiddenControls||(i.controls=!0),!t.isEditMode&&t.hasAutoplay&&(i.autoplay=!0),t.isMuted&&(i.muted=!0),i.playsInline=!0,t.hasLoop&&(i.loop=!0),i}function t396_video__lazyLoadProcessHTMLVideo(e,t){var o;t.hasAutoplay&&!t.isEditMode&&e&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){var t=e.target,o=function o(){t.removeEventListener("loadeddata",o),e.isIntersecting?t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&t.play():t.pause()};t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?o():t.addEventListener("loadeddata",o)}))})).observe(e)}function t396_video__setLoaderForHTMLVideo(e,t,o){if(t){var a=/iPhone|iPad|iPod/i.test(navigator.userAgent)||"ontouchend"in document&&/Macintosh/.test(navigator.userAgent),i='background-image: url("https://tilda.ws/img/spinner-white.gif");';i+="background-repeat: no-repeat; background-position: center;",e.style.cssText+=i,t.addEventListener(a?"loadedmetadata":"canplay",(function(){e.style.backgroundImage="",o&&(e.style.backgroundColor=""),t.style.display="block"}))}}
